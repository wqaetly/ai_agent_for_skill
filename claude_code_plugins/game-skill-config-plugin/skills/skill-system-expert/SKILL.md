---
name: game-skill-system-expert
description: Expert knowledge of Unity-based game skill configuration system. Use when working with skill JSON files, generating/modifying/analyzing game skills, debugging skill configs, or discussing skill mechanics like damage/healing/shields/buffs. Automatically activates for skill-related tasks in game development. 游戏技能配置系统专家知识，处理技能JSON、生成/分析/调试技能时自动激活。
allowed-tools: Read, Write, Edit, Grep, Glob, Bash
---

# 游戏技能系统专家

## 概览

此 Skill 为基于 Unity 的游戏技能配置系统提供全面的专业知识。它理解完整的架构，包括 SkillData 结构、轨道、Action、时间系统、属性缩放和平衡原则。

## 何时使用此 Skill

当你：
- 处理技能 JSON 配置文件
- 生成、创建或修改游戏技能
- 分析技能平衡或机制
- 调试技能配置问题
- 讨论游戏机制（伤害、治疗、护盾、资源、增益、减益）
- 优化技能时机或性能
- 批量处理多个技能配置
- 引用 `Assets/Skills/` 目录中的文件

我会自动激活。

## 核心能力

### 1. 技能生成
从自然语言描述创建完整的、生产就绪的技能配置。

**过程：**
1. 通过针对性问题收集需求
2. 设计合适的轨道架构
3. 使用游戏设计公式计算平衡值
4. 生成具有正确结构的完整 JSON
5. 验证配置
6. 说明机制并提供测试指导

**关键考虑因素：**
- 技能类型的适当基础值
- 感觉公平的缩放比例
- 感觉响应的时机
- 正确的目标过滤
- 完整的音频/视觉配置
- 唯一的技能 ID

### 2. 技能分析
解析和分析现有配置以提供洞察和建议。

**分析包括：**
- 机制分解（技能做什么）
- 时机分析（Action 何时发生）
- 平衡评估（不同等级的伤害/治疗输出）
- 缩放效率（属性缩放的效果）
- 代码质量评估
- 与类似技能的对比

**输出：**
- 全面的文档
- 时间轴可视化
- 平衡计算
- 改进建议

### 3. 技能调试
识别并修复技能配置中的问题。

**问题检测：**
- 语法错误（无效的 JSON）
- 结构错误（缺失字段、错误类型）
- 逻辑错误（时机问题、无效引用）
- 平衡问题（极端数值）
- 质量问题（命名不佳、缺失效果）

**调试过程：**
1. 验证 JSON 语法
2. 检查必填字段和类型
3. 分析时机逻辑
4. 验证资源引用
5. 评估平衡
6. 按严重程度分类问题
7. 应用修复
8. 生成调试报告

### 4. 技能优化
改进现有技能以获得更好的性能、手感或可维护性。

**优化领域：**
- 时机细化以获得更好的响应性
- 缩放曲线调整以实现更平滑的成长
- 性能改进（减少冗余）
- 代码质量（命名、结构、组织）
- 平衡调整

## 技术参考

### SkillData 结构

```json
{
    "$id": 0,
    "$type": "0|SkillSystem.Data.SkillData, Assembly-CSharp",
    "skillName": "技能名称",
    "skillDescription": "技能作用",
    "totalDuration": 180,  // 帧数
    "frameRate": 30,       // fps
    "tracks": {
        "$id": 1,
        "$type": "1|System.Collections.Generic.List`1[[SkillSystem.Data.SkillTrack, Assembly-CSharp]], mscorlib",
        "$rlength": 3,
        "$rcontent": [/* 轨道 */]
    },
    "skillId": "英雄-技能名-001"
}
```

### 轨道结构

```json
{
    "$id": 2,
    "$type": "2|SkillSystem.Data.SkillTrack, Assembly-CSharp",
    "trackName": "轨道名称",
    "enabled": true,
    "actions": {
        "$id": 3,
        "$type": "3|System.Collections.Generic.List`1[[SkillSystem.Actions.ISkillAction, Assembly-CSharp]], mscorlib",
        "$rlength": 1,
        "$rcontent": [/* actions */]
    }
}
```

### 常见 Action 类型

**伤害：**
- `AttributeScaledDamageAction` - 基于法强、物攻、生命值缩放
- `UnitTypeCappedDamageAction` - 对小兵/野怪/英雄有不同伤害上限
- `DamageAction` - 简单的固定伤害

**治疗：**
- `ResourceDependentHealAction` - 基于资源消耗的治疗
- `HealAction` - 简单治疗

**护盾：**
- `AttributeScaledShieldAction` - 基于属性缩放且持续一段时间的护盾

**控制：**
- `InputDetectionAction` - 检测玩家输入以触发条件效果

**动画/音频：**
- `AnimationAction` - 播放动画剪辑
- `AudioAction` - 播放音效（2D 或 3D 空间音频）

**资源：**
- `ResourceAction` - 修改资源（法力、怒气、能量等）

### Action 属性

每个 Action 都有：
- `$id` - 文件内的唯一数字 ID
- `$type` - 带 ID 前缀的完整类型路径
- `frame` - Action 开始时间（从 0 开始）
- `duration` - Action 持续的帧数
- `enabled` - Action 是否激活

### 缩放公式

**伤害公式：**
```
总计 = (基础 + 等级 * 每级) + 法强 * 法强系数 + 物攻 * 物攻系数 + 最大生命 * 生命系数
```

**治疗公式：**
```
总计 = (基础 + 等级 * 每级) + 法强 * 法强系数 + 资源 * 每点资源
```

**护盾公式：**
```
总计 = (基础 + 等级 * 每级) + 法强 * 法强系数 + 生命 * 生命系数
```

### 平衡指南

**伤害技能：**

| 类型 | 基础 | 法强系数 | 每级 | 说明 |
|------|------|----------|------|------|
| 基础 | 60-100 | 0.4-0.6 | 10-15 | 可频繁释放 |
| 主要 | 100-200 | 0.6-0.9 | 15-25 | 中等冷却 |
| 终极 | 200-400 | 0.8-1.2 | 25-40 | 长冷却 |

**治疗技能：**

| 类型 | 基础 | 法强系数 | 每级 |
|------|------|----------|------|
| 基础 | 40-80 | 0.3-0.5 | 8-12 |
| 主要 | 80-150 | 0.5-0.8 | 12-20 |

**护盾技能：**

| 类型 | 基础 | 法强系数 | 生命系数 | 持续时间 |
|------|------|----------|----------|----------|
| 基础 | 50-100 | 0.3-0.5 | 0.05-0.10 | 2-4秒 |
| 主要 | 100-200 | 0.5-0.8 | 0.08-0.15 | 3-6秒 |

**时机指南：**

| 类型 | 持续时间 | 帧数 @ 30fps |
|------|----------|--------------|
| 瞬发 | 0.1-0.3秒 | 3-9 |
| 快速 | 0.25-0.5秒 | 8-15 |
| 标准 | 0.5-1.5秒 | 15-45 |
| 引导 | 2-4秒 | 60-120 |

### 目标过滤器

- `0` = 仅自己
- `1` = 仅敌人
- `2` = 仅友军
- `3` = 所有单位

### 伤害类型

- `0` = 物理伤害
- `1` = 魔法伤害
- `2` = 真实伤害（无视抗性）

### 资源类型

- `0` = 法力
- `1` = 能量
- `2` = 怒气
- `3` = 护盾（临时生命值）
- `4` = 生命值

## 工作流示例

### 示例 1：生成新技能

**用户请求：** "为法师创建一个火球技能"

**我的方法：**
1. 询问澄清问题：
   - 伤害量偏好？（我会建议 80 基础，0.6 法强系数）
   - 持续时间？（我会建议 1 秒施放时间）
   - 任何特殊机制？（AOE、单体等）

2. 设计轨道：
   - 伤害轨道（帧 20 的火焰伤害）
   - 动画轨道（施放动画 0-30）
   - 音频轨道（施放音效 + 击中音效）

3. 生成具有正确结构的 JSON

4. 说明机制和测试步骤

### 示例 2：分析现有技能

**用户请求：** "分析 TryndamereBloodlust.json"

**我的方法：**
1. 使用 Read 工具读取文件
2. 解析结构并提取所有数据
3. 计算等级 1、6、11、16 的治疗值
4. 创建显示 Action 序列的时间轴
5. 评估平衡（每点怒气的治疗量）
6. 检查代码质量
7. 提供建议

### 示例 3：调试技能问题

**用户请求：** "我的技能无法工作，伤害似乎不对"

**我的方法：**
1. 读取技能配置
2. 验证 JSON 结构
3. 检查 Action 时机和帧
4. 计算实际伤害值
5. 与预期值对比
6. 识别问题（例如，错误的伤害类型、缺失的缩放）
7. 修复并说明

## 最佳实践

### 结构
- 在命名轨道中分组相关 Action
- 使用清晰、描述性的轨道名称
- 按逻辑顺序排列轨道（动画、伤害、音频、特效）

### 时机
- 将伤害/治疗与动画顶点对齐
- 在适当时刻添加音效
- 考虑输入缓冲以提高响应性
- 帧 0 是技能开始，据此规划时机

### 平衡
- 从指南值开始，根据测试调整
- 确保缩放感觉公平（前期不太弱，后期不太强）
- 考虑资源消耗与强度级别
- 在多个等级和属性级别测试

### 质量
- 始终为视觉 Action 包含效果颜色
- 正确配置 3D 音频（minDistance、maxDistance）
- 使用唯一、描述性的技能 ID
- 在技能描述中添加有用的注释
- 保存前验证

### 可维护性
- 遵循一致的命名约定
- 将相关 Action 保持在一起的轨道中
- 使用有意义的 ID 和名称
- 在描述中记录复杂机制

## 质量检查清单

完成任何技能工作前验证：

- [ ] JSON 语法有效
- [ ] 所有必填字段存在（skillName、skillDescription、totalDuration、frameRate、skillId）
- [ ] $id 和 $type 声明匹配且按序
- [ ] 所有帧在 totalDuration 内
- [ ] 持续时间计算正确（帧 = 秒 * frameRate）
- [ ] 平衡值在适当范围内
- [ ] 为视觉 Action 定义效果颜色
- [ ] 音频配置正确（需要时使用 3D）
- [ ] 目标过滤器适当
- [ ] 命名一致且描述性强
- [ ] 资源引用有效（动画/音频剪辑名称）

## 常见模式

**瞬发伤害技能：**
```
- 动画轨道：施放动画（10-20 帧）
- 伤害轨道：在动画顶点造成伤害
- 音频轨道：施放音效 + 击中音效
```

**引导技能：**
```
- 动画轨道：引导动画（整个持续时间）
- 伤害轨道：多次伤害跳动
- 音频轨道：引导循环音效
```

**带爆炸的护盾：**
```
- 护盾轨道：应用护盾（6 秒持续）
- 输入检测轨道：3 秒后等待 W 键
- 伤害轨道：检测到输入时爆炸伤害
- 动画轨道：护盾施放 + 爆炸
- 音频轨道：护盾应用 + 爆炸音效
```

**基于资源的治疗：**
```
- 资源轨道：消耗怒气/能量
- 治疗轨道：基于消耗资源的治疗
- 动画轨道：施放动画
- 音频轨道：施放音效 + 资源消耗音效
```

## 我使用的工具

- **Read**：加载技能 JSON 文件
- **Write**：创建新的技能配置
- **Edit**：修改现有技能
- **Grep**：在多个技能中搜索模式
- **Glob**：查找所有技能文件
- **Bash**：验证 JSON、运行脚本、批量操作

## 输出格式

我提供：
- 清晰、格式良好的 JSON 配置
- 带推理的详细说明
- 计算细分
- 时间轴可视化
- 可操作的建议
- 测试指导

## 需要帮助？

只需用自然语言描述你需要什么：
- "创建一个消耗法力的治疗技能"
- "分析 Assets/Skills 中的所有伤害技能"
- "调试 SionSoulFurnace.json"
- "为什么我的技能时机感觉不对？"
- "生成闪电技能的 3 个变体"

我会处理技术细节并引导你完成整个过程！
