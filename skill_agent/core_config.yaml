# skill_agent Core Configuration
# 纯 RAG 逻辑配置，无 MCP/Unity/WebUI 依赖
# 版本: 1.0.0

# ==================== 嵌入模型配置 ====================
embedding:
  # Qwen3-Embedding-0.6B 本地模型（已下载完整权重）
  model_name: "Data/models/Qwen3-Embedding-0.6B"
  device: "cpu"  # 或 "cuda" 如果有 GPU
  batch_size: 32
  max_length: 8192  # Qwen3 支持 32K，设为 8192 平衡性能
  cache_dir: null  # null 使用系统默认缓存
  use_flash_attention: false  # CPU 不支持

# ==================== 向量数据库配置 ====================
vector_store:
  type: "pgvector"  # 使用 PostgreSQL pgvector 扩展
  pg_dsn: "postgresql://postgres:postgres@localhost:5432/skill_agent"
  table_prefix: "vs"
  collection_name: "skill_collection"
  distance_metric: "cosine"  # cosine, l2, ip

# ==================== 技能索引配置 ====================
skill_indexer:
  # 技能文件目录（相对路径）
  skills_directory: "../ai_agent_for_skill/Assets/Skills"

  # 文件监听
  watch_enabled: true

  # 索引缓存
  index_cache: "Data/skill_index.json"

  # 索引字段
  index_fields:
    - "skillName"
    - "skillDescription"
    - "skillId"
    - "actions"

  # Action 详细信息索引
  index_action_details: true

  # 自动重建索引间隔（秒），0 表示仅在启动和文件变化时
  auto_reindex_interval: 0

# ==================== Action 索引配置 ====================
action_indexer:
  # Unity 导出的 Action JSON 文件目录
  actions_directory: "Data/Actions"

  # Action 索引缓存
  action_index_cache: "Data/action_index.json"

  # Action 向量 collection（独立于技能 collection）
  collection_name: "action_collection"

# ==================== RAG 检索配置 ====================
rag:
  # 检索参数
  top_k: 5  # 返回最相似的 K 个结果
  similarity_threshold: 0.1  # 相似度阈值（0-1），降低以提高召回率

  # 重排序
  rerank_enabled: false  # 可扩展

  # 缓存配置
  cache_enabled: true
  cache_ttl: 3600  # 缓存生存时间（秒）

# ==================== 日志配置 ====================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  file: "Data/rag_core.log"
  max_bytes: 10485760  # 10MB
  backup_count: 3

  # 日志格式
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  date_format: "%Y-%m-%d %H:%M:%S"
