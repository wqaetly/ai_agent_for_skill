# REQ-01 Action选择合理性补足 - 快速开始

## 5分钟快速上手

### 第一步：启动功能

1. 打开 Unity 编辑器
2. 菜单栏选择：**技能系统 → RAG查询窗口**
3. 切换到 **"Action推荐"** 标签
4. 勾选 **"使用增强推荐"** 选项

### 第二步：测试推荐

在文本框中输入查询，例如：

```
造成范围伤害的技能效果
```

点击 **"获取推荐"** 按钮，你将看到：

- **综合得分**：基于语义相似度、频次惩罚和业务优先级计算
- **推荐理由**：为什么推荐这个Action
- **警告信息**：潜在的使用问题
- **使用建议**：如何更好地使用这个Action

### 第三步：查看配置（可选）

1. 菜单栏选择：**技能系统 → Action语义配置管理**
2. 点击 **"在编辑器中打开"** 查看配置文件
3. 修改配置后，点击 **"重新加载配置"** 应用更改

### 第四步：测试功能

在配置管理窗口中：

1. 点击 **"执行健康检查"** 验证系统状态
2. 点击 **"测试约束验证"** 查看约束规则效果
3. 点击 **"测试评分系统"** 查看评分详情

## 常见场景示例

### 场景1：查找伤害类Action

**输入**：`对敌人造成伤害`

**预期结果**：
- DamageAction（高分）
- AttributeScaledDamageAction（中等）
- 不会推荐 HealAction（互斥过滤）

### 场景2：查找防御类Action

**输入**：`保护队友免受伤害`

**预期结果**：
- ShieldAction（高分，有"保护"关键词）
- 提示协同使用 HealAction
- 警告与 DamageAction 的潜在冲突

### 场景3：查找位移类Action

**输入**：`快速移动到目标位置`

**预期结果**：
- MovementAction（高分）
- 不会推荐为"击退"效果（语义区分）
- 建议搭配 DamageAction

## 核心概念速查

### 综合评分公式

```
最终得分 = 语义相似度 × (1-频次惩罚) × 0.7 + 业务优先级 × 0.3
```

- **语义相似度**：来自 RAG 的向量相似度（0-1）
- **频次惩罚**：抑制高频Action过度推荐（0-1）
- **业务优先级**：项目定制权重（0-2）

### 验证状态

- ✅ **通过**：绿色边框，无冲突
- ⚠️ **警告**：黄色边框，有潜在问题
- ❌ **失败**：红色边框，存在严重冲突

### 规则类型

| 类型 | 说明 | 示例 |
|------|------|------|
| Exclusive | 互斥，不能同时使用 | Damage ⟷ Heal |
| Prerequisite | 前置，需要先有其他Action | Effect → Visual |
| Synergy | 协同，推荐组合使用 | Damage + Control |

## 配置自定义

### 调整Action频次惩罚

编辑 `ActionSemanticConfig.json`：

```json
{
  "actionType": "DamageAction",
  "frequencyPenalty": 0.3  // 0-1，越大惩罚越重
}
```

### 添加互斥规则

```json
{
  "ruleName": "MyRule",
  "ruleType": "Exclusive",
  "actionTypes": ["Action1", "Action2"],
  "description": "这两个Action不能同时使用",
  "priority": 10,
  "enabled": true
}
```

### 添加协同推荐

```json
{
  "dependency": {
    "synergies": ["ShieldAction", "HealAction"]
  }
}
```

## 验收标准验证

### 检查互斥比例

查看控制台日志：

```
[ActionRecommendationScorer] Exclusive ratio in top-3: 2.5%
```

应该 **< 5%** ✅

### 检查推荐理由

每条推荐应该有至少1条理由，在UI中展开 **"推荐理由"** 查看。

### 测试热更新

1. 修改配置文件
2. 点击 **"重新加载配置"**
3. 再次执行推荐，查看变化

## 故障排查

### 问题：推荐结果为空

**原因**：RAG服务未启动或配置错误

**解决**：
1. 检查服务器连接状态（窗口顶部）
2. 点击 **"启动服务器"** 按钮
3. 确认 `127.0.0.1:8765` 可访问

### 问题：增强推荐无效果

**原因**：未勾选"使用增强推荐"或配置加载失败

**解决**：
1. 确认勾选增强推荐开关
2. 打开配置管理窗口，执行健康检查
3. 查看控制台是否有错误日志

### 问题：配置修改不生效

**原因**：未重新加载配置

**解决**：
1. 保存配置文件
2. 在配置管理窗口点击 **"重新加载配置"**
3. 等待成功提示

## 下一步

- 📖 阅读完整文档：`REQ01_Implementation.md`
- 🔧 自定义配置：根据项目需求调整语义和规则
- 🧪 编写测试：使用配置管理窗口的测试工具
- 🚀 集成到工作流：在技能设计流程中使用增强推荐

## 反馈与支持

如有问题或建议，请查看：
- 实现文档：`docs/mcp_requirements/REQ01_Implementation.md`
- 原始需求：`docs/mcp_requirements/REQ01_ActionSelectionRationality.md`
