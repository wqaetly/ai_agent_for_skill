# REQ-01 Action选择合理性补足

**状态**: [已实现-归档] | **优先级**: 已完成 | **关联**: REQ-07（已删除，功能合并）

## 背景
- 现有RAG仅依据语义相似度返回Action，易把MovementAction误判为击退动作。
- 高频Action因为向量相似度偏高被过度推荐，缺乏组合约束与推理说明。

## 目标
- 构建Action语义与约束知识库，确保推荐结果符合技能设计逻辑。
- 在推荐列表中剔除互斥或语义不匹配的Action组合并给出解释。
- 建立可调节的评分模型，允许根据项目阶段修正权重与规则。

## 范围
- ✅ 覆盖Action语义本体、组合约束、频次调权和解释生成。
- ❌ 不负责具体参数推理；由ParameterInferencer承担。

## 实现步骤
1. 汇总Action元数据与设计规范，抽象成“用途-效果-依赖”三层本体。
2. 在推荐流程中注入组合校验器，判定互斥、缺失前置等情况。
3. 设计综合评分：语义相似度 ×(1-惩罚) + 业务prior，抑制高频噪声。
4. 输出解释链，记录触发的规则、参考技能与置信度，便于调试。

## 数据与集成
- 依赖Action元数据JSON、技能统计索引与RAG召回结果。
- 产出供Tool3/Tool4调用的校验接口，并在日志中写入推荐细节。

## 验收标准
- Top-3 Action推荐中互斥组合比例 < 5%。
- 每条推荐包含至少1条可读原因或参考记录。
- 规则表可通过配置文件热更新且附带单元测试。

## 风险与缓解
- 元数据不完整 → 提供人工补充表并在缺失时降级为语义结果。
- 规则冲突 → 加入优先级和互斥标记，CI校验重复定义。

## 指标
- action_pair_precision、被拒绝的推荐占比、解释生成成功率。

## 交付产出
- Action语义/约束矩阵、推荐过滤模块、测试样例及调参Runbook。
